/* build 2013-10-25 17:36:38 */
KISSY.add(function(S,Calendar){var Event=S.Event,DOM=S.DOM,Anim=S.Anim,Ajax=S.io,S_Date=S.Date,JSON=S.JSON,UA=S.UA,win=window,doc=document;function TL(){var _self=this;if(!(_self instanceof TL)){return new TL}}S.extend(TL,S.Base);S.augment(TL,{dateRenderer:function(d){if(!d){return""}if(S.isString(d)){return d}var date=null;try{date=new Date(d)}catch(e){return""}if(!date||!date.getFullYear){return""}return S_Date.format(d,"yyyy-mm-dd")},datetimeRenderer:function(d){if(!d){return""}if(S.isString(d)){return d}var date=null;try{date=new Date(d)}catch(e){return""}if(!date||!date.getFullYear){return""}return S_Date.format(d,"yyyy-mm-dd HH:MM:ss")},getDateParse:function(dateStr){return S_Date.parse(dateStr.replace(/\-/g,"/"))},getDateObj:function(dateStr,offset,PreviousLater){var dataParse=dateStr?S.TL.getDateParse(dateStr):(new Date).getTime(),offsetParse=offset?offset*864e5:0,dataTime;switch(PreviousLater){case"+":dataTime=dataParse+offsetParse;break;case"-":dataTime=dataParse-offsetParse;break;default:dataTime=dataParse}return new Date(dataTime)},cutTextRenderer:function(length){return function(value){value=value||"";if(value.toString().length>length){return value.toString().substring(0,length)+"..."}return value}},strToDataType:function(value){var dataType="string",date="",val=parseInt(value,10),isNumber=S.isNumber(value),isString=S.isString(value);if(!value){return}if(isNumber){if(/\./g.test(value)){dataType="float"}else{dataType="int"}}else if(isString){date=this.getDateParse(value);if(date.getFullYear){dataType="date"}}return dataType},moneyCentRenderer:function(v,fixed){if(S.isString(v)){v=parseFloat(v)}if(S.isNumber(v)){return(v*.01).toFixed(fixed||2)}return v},getFiledValue:function(obj,index){if(!obj&&!index){return}var resultData=obj,aindex=index.split(".");S.each(aindex,function(dataIndex){if(resultData){resultData=resultData[dataIndex]}});return resultData},selectedAllBox:function(cls,isChecked,thatDoc){var selectedAry=[],thatDoc=thatDoc||document,groupRadios=S.query(cls,thatDoc);S.each(groupRadios,function(el){var trID=DOM.val(el);if(isChecked){el.checked="checked";selectedAry.push(trID)}else{el.checked="";DOM.removeAttr(el,"checked")}});return selectedAry},serialize:function(form){return S.param(S.TL.serializeToObject(form))},serializeToObject:function(form){var originElements=S.makeArray(form.elements),elements=null,arr=[],checkboxElements=null,result={};elements=S.filter(originElements,function(item){return(item.id||item.name)&&!item.disabled&&(item.checked||/select|textarea/i.test(item.nodeName)||/text|hidden|password/i.test(item.type))});checkboxElements=S.filter(originElements,function(item){return(item.id||item.name)&&!item.disabled&&/checkbox/i.test(item.type)});S.each(elements,function(elem){var val=S.one(elem).val(),name=elem.name||elem.id,obj=val==null?{name:name,value:""}:S.isArray(val)?S.map(val,function(val,i){return{name:name,value:val}}):{name:name,value:val};if(obj){arr.push(obj)}});S.each(arr,function(elem){var prop=result[elem.name],a=[];if(!prop){result[elem.name]=elem.value}else if(S.isArray(prop)){prop.push(elem.value)}else{a.push(prop);a.push(elem.value);result[elem.name]=a}});S.each(checkboxElements,function(elem){var name=elem.name||elem.id;if(!result.hasOwnProperty(name)){result[name]=""}});return result},encodeURIParam:function(vals,isDoubEncode){var _self=this;if(!vals){return}if(S.isString(vals)){return isDoubEncode?encodeURI(encodeURI(vals)):encodeURI(vals)}if(S.isArray(vals)){S.each(vals,function(val,i){vals[i]=isDoubEncode?encodeURI(encodeURI(val)):encodeURI(val)});return vals}if(S.isObject(vals)){S.each(vals,function(value,index){vals[index]=_self.encodeURIParam(value,isDoubEncode)});return vals}return vals}});S.TL=S.namespace("TL");S.TL=new TL;return TL},{requires:["calendar","core"]});